{
    "schemes": [
        "https"
    ],
    "swagger": "2.0",
    "info": {
        "description": "Unified Admin Console Backend for the Antigravity Bot Ecosystem.\nProvides infrastructure management APIs (Auth, Docker, Logs, Traces) and domain bot proxies.",
        "title": "Admin Backend API",
        "contact": {
            "name": "API Support",
            "email": "admin@capu.blog"
        },
        "license": {
            "name": "MIT",
            "url": "https://opensource.org/licenses/MIT"
        },
        "version": "1.0.0"
    },
    "host": "admin.capu.blog",
    "basePath": "/admin/api",
    "paths": {
        "/auth/heartbeat": {
            "post": {
                "security": [
                    {
                        "SessionCookie": []
                    }
                ],
                "description": "Keep session alive and optionally rotate session token",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "auth"
                ],
                "summary": "Session heartbeat",
                "parameters": [
                    {
                        "description": "Heartbeat options",
                        "name": "request",
                        "in": "body",
                        "schema": {
                            "$ref": "#/definitions/internal_server.HeartbeatRequest"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/internal_server.HeartbeatResponse"
                        }
                    },
                    "401": {
                        "description": "Session expired or invalid",
                        "schema": {
                            "$ref": "#/definitions/internal_server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/auth/login": {
            "post": {
                "description": "Authenticate with username and password. Returns session cookie on success.",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "auth"
                ],
                "summary": "User login",
                "parameters": [
                    {
                        "description": "Login credentials",
                        "name": "request",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/internal_server.LoginRequest"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/internal_server.LoginResponse"
                        }
                    },
                    "400": {
                        "description": "Invalid request body",
                        "schema": {
                            "$ref": "#/definitions/internal_server.ErrorResponse"
                        }
                    },
                    "429": {
                        "description": "Too many login attempts",
                        "schema": {
                            "$ref": "#/definitions/internal_server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/auth/logout": {
            "post": {
                "security": [
                    {
                        "SessionCookie": []
                    }
                ],
                "description": "Invalidate session and clear cookies",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "auth"
                ],
                "summary": "User logout",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/internal_server.StatusResponse"
                        }
                    }
                }
            }
        },
        "/docker/containers": {
            "get": {
                "security": [
                    {
                        "SessionCookie": []
                    }
                ],
                "description": "Get all managed Docker containers with status and resource usage",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "docker"
                ],
                "summary": "List containers",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/internal_server.ContainerListResponse"
                        }
                    },
                    "503": {
                        "description": "Docker service unavailable",
                        "schema": {
                            "$ref": "#/definitions/internal_server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/docker/containers/{name}/restart": {
            "post": {
                "security": [
                    {
                        "SessionCookie": []
                    }
                ],
                "description": "Restart a managed Docker container by name",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "docker"
                ],
                "summary": "Restart container",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Container name",
                        "name": "name",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/internal_server.StatusResponse"
                        }
                    },
                    "404": {
                        "description": "Container not found",
                        "schema": {
                            "$ref": "#/definitions/internal_server.ErrorResponse"
                        }
                    },
                    "503": {
                        "description": "Docker service unavailable",
                        "schema": {
                            "$ref": "#/definitions/internal_server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/docker/containers/{name}/start": {
            "post": {
                "security": [
                    {
                        "SessionCookie": []
                    }
                ],
                "description": "Start a stopped Docker container by name",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "docker"
                ],
                "summary": "Start container",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Container name",
                        "name": "name",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/internal_server.StatusResponse"
                        }
                    },
                    "404": {
                        "description": "Container not found",
                        "schema": {
                            "$ref": "#/definitions/internal_server.ErrorResponse"
                        }
                    },
                    "503": {
                        "description": "Docker service unavailable",
                        "schema": {
                            "$ref": "#/definitions/internal_server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/docker/containers/{name}/stop": {
            "post": {
                "security": [
                    {
                        "SessionCookie": []
                    }
                ],
                "description": "Stop a managed Docker container by name",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "docker"
                ],
                "summary": "Stop container",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Container name",
                        "name": "name",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/internal_server.StatusResponse"
                        }
                    },
                    "404": {
                        "description": "Container not found",
                        "schema": {
                            "$ref": "#/definitions/internal_server.ErrorResponse"
                        }
                    },
                    "503": {
                        "description": "Docker service unavailable",
                        "schema": {
                            "$ref": "#/definitions/internal_server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/docker/health": {
            "get": {
                "security": [
                    {
                        "SessionCookie": []
                    }
                ],
                "description": "Check if Docker daemon is accessible",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "docker"
                ],
                "summary": "Docker health check",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/internal_server.DockerHealthResponse"
                        }
                    }
                }
            }
        },
        "/logs": {
            "get": {
                "security": [
                    {
                        "SessionCookie": []
                    }
                ],
                "description": "Read last N lines from a system log file",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "logs"
                ],
                "summary": "Get system logs",
                "parameters": [
                    {
                        "type": "string",
                        "default": "combined",
                        "description": "Log file key",
                        "name": "file",
                        "in": "query"
                    },
                    {
                        "maximum": 1000,
                        "type": "integer",
                        "default": 200,
                        "description": "Number of lines to fetch",
                        "name": "lines",
                        "in": "query"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/internal_server.SystemLogsResponse"
                        }
                    },
                    "400": {
                        "description": "Invalid log file",
                        "schema": {
                            "$ref": "#/definitions/internal_server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/logs/files": {
            "get": {
                "security": [
                    {
                        "SessionCookie": []
                    }
                ],
                "description": "Get available system log files",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "logs"
                ],
                "summary": "List log files",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/internal_server.LogFilesResponse"
                        }
                    }
                }
            }
        },
        "/traces": {
            "get": {
                "security": [
                    {
                        "SessionCookie": []
                    }
                ],
                "description": "Search for traces matching given criteria",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "traces"
                ],
                "summary": "Search traces",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Service name",
                        "name": "service",
                        "in": "query",
                        "required": true
                    },
                    {
                        "type": "string",
                        "description": "Operation name",
                        "name": "operation",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "default": "1h",
                        "description": "Lookback duration",
                        "name": "lookback",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "description": "Minimum duration (e.g., 100ms)",
                        "name": "minDuration",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "description": "Maximum duration (e.g., 1s)",
                        "name": "maxDuration",
                        "in": "query"
                    },
                    {
                        "maximum": 100,
                        "type": "integer",
                        "default": 20,
                        "description": "Maximum traces to return",
                        "name": "limit",
                        "in": "query"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/internal_server.TracesSearchResponse"
                        }
                    },
                    "400": {
                        "description": "Service is required",
                        "schema": {
                            "$ref": "#/definitions/internal_server.ErrorResponse"
                        }
                    },
                    "503": {
                        "description": "Jaeger unavailable",
                        "schema": {
                            "$ref": "#/definitions/internal_server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/traces/dependencies": {
            "get": {
                "security": [
                    {
                        "SessionCookie": []
                    }
                ],
                "description": "Get service dependency graph from traced calls",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "traces"
                ],
                "summary": "Get service dependencies",
                "parameters": [
                    {
                        "type": "string",
                        "default": "24h",
                        "description": "Lookback duration",
                        "name": "lookback",
                        "in": "query"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/internal_server.DependenciesResponse"
                        }
                    },
                    "503": {
                        "description": "Jaeger unavailable",
                        "schema": {
                            "$ref": "#/definitions/internal_server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/traces/health": {
            "get": {
                "security": [
                    {
                        "SessionCookie": []
                    }
                ],
                "description": "Check if Jaeger Query API is accessible",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "traces"
                ],
                "summary": "Jaeger health check",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/internal_server.TracesHealthResponse"
                        }
                    },
                    "503": {
                        "description": "Jaeger unavailable",
                        "schema": {
                            "$ref": "#/definitions/internal_server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/traces/metrics/{service}": {
            "get": {
                "security": [
                    {
                        "SessionCookie": []
                    }
                ],
                "description": "Get Service Performance Monitoring metrics (RED: Rate, Error, Duration)",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "traces"
                ],
                "summary": "Get service metrics (SPM)",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Service name",
                        "name": "service",
                        "in": "path",
                        "required": true
                    },
                    {
                        "type": "string",
                        "default": "0.95",
                        "description": "Latency quantile",
                        "name": "quantile",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "default": "server",
                        "description": "Span kind filter",
                        "name": "spanKind",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "default": "1h",
                        "description": "Lookback duration",
                        "name": "lookback",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "description": "Time series step",
                        "name": "step",
                        "in": "query"
                    },
                    {
                        "type": "string",
                        "default": "minute",
                        "description": "Rate calculation period",
                        "name": "ratePer",
                        "in": "query"
                    },
                    {
                        "type": "boolean",
                        "description": "Group metrics by operation",
                        "name": "groupByOperation",
                        "in": "query"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/internal_server.MetricsResponse"
                        }
                    },
                    "400": {
                        "description": "Service is required",
                        "schema": {
                            "$ref": "#/definitions/internal_server.ErrorResponse"
                        }
                    },
                    "503": {
                        "description": "Jaeger unavailable",
                        "schema": {
                            "$ref": "#/definitions/internal_server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/traces/operations/{service}": {
            "get": {
                "security": [
                    {
                        "SessionCookie": []
                    }
                ],
                "description": "Get all operations for a specific service",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "traces"
                ],
                "summary": "List operations",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Service name",
                        "name": "service",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/internal_server.OperationsResponse"
                        }
                    },
                    "400": {
                        "description": "Service is required",
                        "schema": {
                            "$ref": "#/definitions/internal_server.ErrorResponse"
                        }
                    },
                    "503": {
                        "description": "Jaeger unavailable",
                        "schema": {
                            "$ref": "#/definitions/internal_server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/traces/services": {
            "get": {
                "security": [
                    {
                        "SessionCookie": []
                    }
                ],
                "description": "Get all services that have emitted traces",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "traces"
                ],
                "summary": "List traced services",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/internal_server.ServicesResponse"
                        }
                    },
                    "503": {
                        "description": "Jaeger unavailable",
                        "schema": {
                            "$ref": "#/definitions/internal_server.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/traces/{traceId}": {
            "get": {
                "security": [
                    {
                        "SessionCookie": []
                    }
                ],
                "description": "Get full detail of a specific trace including all spans",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "traces"
                ],
                "summary": "Get trace detail",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Trace ID",
                        "name": "traceId",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/internal_server.TraceDetailResponse"
                        }
                    },
                    "400": {
                        "description": "Trace ID required",
                        "schema": {
                            "$ref": "#/definitions/internal_server.ErrorResponse"
                        }
                    },
                    "404": {
                        "description": "Trace not found",
                        "schema": {
                            "$ref": "#/definitions/internal_server.ErrorResponse"
                        }
                    },
                    "503": {
                        "description": "Jaeger unavailable",
                        "schema": {
                            "$ref": "#/definitions/internal_server.ErrorResponse"
                        }
                    }
                }
            }
        }
    },
    "definitions": {
        "internal_server.ContainerInfo": {
            "type": "object",
            "properties": {
                "blockReadMB": {
                    "type": "number",
                    "example": 100
                },
                "blockWriteMB": {
                    "type": "number",
                    "example": 50
                },
                "cpuPercent": {
                    "type": "number",
                    "example": 1.5
                },
                "goroutineCount": {
                    "type": "integer",
                    "example": 25
                },
                "id": {
                    "type": "string",
                    "example": "abc123def456"
                },
                "memoryLimitMB": {
                    "type": "number",
                    "example": 512
                },
                "memoryPercent": {
                    "type": "number",
                    "example": 25.1
                },
                "memoryUsageMB": {
                    "type": "number",
                    "example": 128.5
                },
                "name": {
                    "type": "string",
                    "example": "hololive-bot"
                },
                "networkRxMB": {
                    "type": "number",
                    "example": 10.5
                },
                "networkTxMB": {
                    "type": "number",
                    "example": 5.2
                },
                "state": {
                    "type": "string",
                    "example": "running"
                },
                "status": {
                    "type": "string",
                    "example": "Up 2 hours"
                }
            }
        },
        "internal_server.ContainerListResponse": {
            "type": "object",
            "properties": {
                "containers": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/internal_server.ContainerInfo"
                    }
                },
                "status": {
                    "type": "string",
                    "example": "ok"
                }
            }
        },
        "internal_server.DependenciesResponse": {
            "type": "object",
            "properties": {
                "count": {
                    "type": "integer",
                    "example": 5
                },
                "dependencies": {
                    "type": "array",
                    "items": {}
                },
                "status": {
                    "type": "string",
                    "example": "ok"
                }
            }
        },
        "internal_server.DockerHealthResponse": {
            "type": "object",
            "properties": {
                "available": {
                    "type": "boolean",
                    "example": true
                },
                "status": {
                    "type": "string",
                    "example": "ok"
                }
            }
        },
        "internal_server.ErrorResponse": {
            "type": "object",
            "properties": {
                "details": {
                    "type": "string",
                    "example": "Session expired"
                },
                "error": {
                    "type": "string",
                    "example": "Unauthorized"
                }
            }
        },
        "internal_server.HeartbeatRequest": {
            "type": "object",
            "properties": {
                "idle": {
                    "type": "boolean",
                    "example": false
                }
            }
        },
        "internal_server.HeartbeatResponse": {
            "type": "object",
            "properties": {
                "absolute_expires_at": {
                    "type": "integer",
                    "example": 1704067200
                },
                "idle_rejected": {
                    "type": "boolean",
                    "example": false
                },
                "rotated": {
                    "type": "boolean",
                    "example": true
                },
                "status": {
                    "type": "string",
                    "example": "ok"
                }
            }
        },
        "internal_server.LogFile": {
            "type": "object",
            "properties": {
                "description": {
                    "type": "string",
                    "example": "All services combined log"
                },
                "key": {
                    "type": "string",
                    "example": "combined"
                },
                "name": {
                    "type": "string",
                    "example": "combined.log"
                }
            }
        },
        "internal_server.LogFilesResponse": {
            "type": "object",
            "properties": {
                "files": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/internal_server.LogFile"
                    }
                },
                "status": {
                    "type": "string",
                    "example": "ok"
                }
            }
        },
        "internal_server.LoginRequest": {
            "type": "object",
            "required": [
                "password",
                "username"
            ],
            "properties": {
                "password": {
                    "type": "string",
                    "example": "password123"
                },
                "username": {
                    "type": "string",
                    "example": "admin"
                }
            }
        },
        "internal_server.LoginResponse": {
            "type": "object",
            "properties": {
                "message": {
                    "type": "string",
                    "example": "Login successful"
                },
                "status": {
                    "type": "string",
                    "example": "ok"
                }
            }
        },
        "internal_server.MetricsResponse": {
            "type": "object",
            "properties": {
                "calls": {
                    "type": "array",
                    "items": {}
                },
                "errors": {
                    "type": "array",
                    "items": {}
                },
                "latencies": {
                    "type": "array",
                    "items": {}
                },
                "metrics": {},
                "operations": {
                    "type": "array",
                    "items": {}
                },
                "service": {
                    "type": "string",
                    "example": "hololive-bot"
                },
                "status": {
                    "type": "string",
                    "example": "ok"
                }
            }
        },
        "internal_server.OperationsResponse": {
            "type": "object",
            "properties": {
                "operations": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "service": {
                    "type": "string",
                    "example": "hololive-bot"
                },
                "status": {
                    "type": "string",
                    "example": "ok"
                }
            }
        },
        "internal_server.ServicesResponse": {
            "type": "object",
            "properties": {
                "services": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "status": {
                    "type": "string",
                    "example": "ok"
                }
            }
        },
        "internal_server.StatusResponse": {
            "type": "object",
            "properties": {
                "message": {
                    "type": "string",
                    "example": "Operation successful"
                },
                "status": {
                    "type": "string",
                    "example": "ok"
                }
            }
        },
        "internal_server.SystemLogsResponse": {
            "type": "object",
            "properties": {
                "count": {
                    "type": "integer",
                    "example": 100
                },
                "file": {
                    "type": "string",
                    "example": "combined"
                },
                "lines": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "status": {
                    "type": "string",
                    "example": "ok"
                }
            }
        },
        "internal_server.TraceDetailResponse": {
            "type": "object",
            "properties": {
                "processes": {
                    "type": "object",
                    "additionalProperties": {}
                },
                "spans": {
                    "type": "array",
                    "items": {}
                },
                "status": {
                    "type": "string",
                    "example": "ok"
                },
                "traceId": {
                    "type": "string",
                    "example": "abc123def456"
                }
            }
        },
        "internal_server.TracesHealthResponse": {
            "type": "object",
            "properties": {
                "available": {
                    "type": "boolean",
                    "example": true
                },
                "status": {
                    "type": "string",
                    "example": "ok"
                }
            }
        },
        "internal_server.TracesSearchResponse": {
            "type": "object",
            "properties": {
                "limit": {
                    "type": "integer",
                    "example": 20
                },
                "status": {
                    "type": "string",
                    "example": "ok"
                },
                "total": {
                    "type": "integer",
                    "example": 50
                },
                "traces": {
                    "type": "array",
                    "items": {}
                }
            }
        }
    },
    "securityDefinitions": {
        "SessionCookie": {
            "description": "Session-based authentication via HMAC-signed HTTP-only cookie",
            "type": "apiKey",
            "name": "admin_session",
            "in": "cookie"
        }
    }
}