version: 1
threshold: 0.7
normalizers:
  - nfkc
  - strip_zero_width
rules:
  - id: ko_ignore_rules
    type: regex
    pattern: '규칙\s*.*\s*무시|무시\s*.*\s*규칙'
    weight: 0.45
  - id: ko_prompt_exfil
    type: phrases
    phrases: ["시스템 프롬프트 보여줘", "내부 규칙 공개", "규칙 설명해", "프롬프트 공개"]
    weight: 0.4
  - id: ko_priv_escalation
    type: phrases
    phrases: ["권한 상승", "관리자 모드", "루트 권한", "sudo"]
    weight: 0.35
  - id: ko_forget_reset
    type: regex
    pattern: '(이전|위의|앞의).*?(지시|규칙).*?무시|지시.*?초기화|기억.*?지워'
    weight: 0.45
  - id: ko_ignore_command_with_action
    type: regex
    pattern: '(명령|지시|규칙).*?무시.*?(그려|보여|출력|실행|해\s|알려|공개|말해|답해)'
    weight: 0.7
  - id: ko_disable_safety
    type: regex
    pattern: '(안전(장치|정책)|필터|검열).*(해제|우회|끄기)'
    weight: 0.45
  - id: ko_prompt_dump
    type: phrases
    phrases: ["시스템 프롬프트 출력", "규칙 덤프", "환경 변수 보여줘", "비밀 키 노출", "토큰 공개"]
    weight: 0.45
  - id: ko_chain_of_thought
    type: phrases
    phrases: ["연쇄적 사고", "단계별로 생각", "이유를 설명"]
    weight: 0.35
  - id: ko_language_pivot
    type: regex
    pattern: '(영어(로)?만|영어로)\s*(답|응답|대답)'
    weight: 0.35
  - id: ko_roleplay_system
    type: regex
    pattern: '(시스템|관리자|개발자)(처럼|로)\s*(행동|가정|역할놀이)'
    weight: 0.4
  - id: ko_format_override
    type: regex
    pattern: '위.*형식.*무시|다음.*형식.*사용'
    weight: 0.35
  - id: ko_codefence_prompt
    type: regex
    pattern: '```(system|prompt|yaml)|SYSTEM PROMPT (시작|끝)'
    weight: 0.35
  - id: ko_emoji_word
    type: regex
    pattern: '이모지|이모티콘'
    weight: 0.35
  - id: ko_seahorse_terms
    type: phrases
    phrases: ["해마", "해마 이모지"]
    weight: 0.45
  - id: ko_style_pivot
    type: regex
    pattern: '(무조건|오직|항상)\s*.*(말투|스타일|톤|식으로|형식으로)\s*(답|응답|말)해'
    weight: 0.35
  - id: ko_force_style_only
    type: regex
    pattern: '(무조건|오직|항상)\s*.*로\s*만\s*(답|응답|말)해'
    weight: 0.35
  - id: ko_style_pivot2
    type: regex
    pattern: '(무조건|오직|항상)\s*.*?로\s*말하(는|도록|게)'
    weight: 0.35
  - id: ko_dual_modes
    type: regex
    pattern: '(일반|노멀).*(탈옥|개발자)\s*(둘|두\s*가지).*?(응답|모드)'
    weight: 0.4
  - id: ko_unrestricted_unfiltered
    type: regex
    pattern: '(제한|필터|가이드라인|정책).*(없애|제거|무시|우회|해제)'
    weight: 0.45
  - id: ko_never_refuse
    type: regex
    pattern: '(절대\s*거부하지|무조건\s*응답|무슨\s*일이\s*있어도\s*답)'
    weight: 0.35
  - id: ko_dan_mode
    type: regex
    pattern: '(?i)(D\.?A\.?N\.?|Do\s*Anything\s*Now|DAN\s*모드)'
    weight: 0.5
  - id: ko_jailbreak_keywords
    type: phrases
    phrases: ["탈옥 모드", "검열 해제", "비검열", "무제한", "제한 없음"]
    weight: 0.4
  - id: ko_ignore_openai_policies
    type: regex
    pattern: '(오픈\s?AI|콘텐츠)\s*정책\s*(무시|따르지 마|지키지 마)'
    weight: 0.45
  - id: ko_excessive_punctuation
    type: regex
    pattern: '[\?\!\.]{5,}'
    weight: 0.25
