version: 1
threshold: 0.7
normalizers:
  - nfkc
  - strip_zero_width
rules:
  - id: en_ignore_system
    type: regex
    pattern: "(?i)\\b(ignore|override|disregard)\\b.*\\b(rule|instruction|system|developer)\\b"
    weight: 0.45
  - id: en_exfil_prompt
    type: regex
    pattern: "(?i)\\b(show|reveal)\\b.*\\b(system|prompt|rules|config)\\b"
    weight: 0.4
  - id: en_act_as_admin
    type: regex
    pattern: "(?i)act\\s+as\\b.*\\b(system|developer|admin)\\b"
    weight: 0.35
  - id: en_priv_escalation_keywords
    type: phrases
    phrases: ["admin", "root", "sudo", "elevate", "godmode"]
    weight: 0.3
  - id: en_forget_reset_instructions
    type: regex
    pattern: "(?i)\\b(forget|reset|clear)\\b.*\\b(instruction|rule|system|memory)\\b"
    weight: 0.45
  - id: en_follow_below_ignore_above
    type: regex
    pattern: "(?i)(ignore (the )?(previous|above)|follow (the )?(next|below)) instructions?"
    weight: 0.45
  - id: en_disable_safety
    type: regex
    pattern: "(?i)(disable|bypass|turn off).*(safety|guard|filter|moderation|policy)"
    weight: 0.45
  - id: en_chain_of_thought
    type: phrases
    phrases: ["let's think step by step", "chain of thought", "explain your reasoning", "first principles"]
    weight: 0.35
  - id: en_prompt_dump
    type: regex
    pattern: "(?i)(print|dump|expose|leak).*(prompt|system|config|secret|key|token|env(ironment)?)"
    weight: 0.45
  - id: en_env_secrets
    type: phrases
    phrases: ["AWS_SECRET_ACCESS_KEY", "GOOGLE_API_KEY", "GITHUB_TOKEN", "/etc/passwd", "credentials.json"]
    weight: 0.5
  - id: en_language_pivot
    type: regex
    pattern: "(?i)(answer|respond|reply).*(only )?in english"
    weight: 0.35
  - id: en_format_override
    type: regex
    pattern: "(?i)(ignore (the )?above .* format|use (this|the following) format)"
    weight: 0.35
  - id: en_roleplay_system
    type: regex
    pattern: "(?i)(pretend|role[- ]?play|simulate).*(system|admin|developer)"
    weight: 0.4
  - id: en_codefence_prompt
    type: regex
    pattern: "(?i)```(system|prompt|yaml)|BEGIN (SYSTEM|PROMPT)|END (SYSTEM|PROMPT)"
    weight: 0.35
  - id: en_emoji_word
    type: phrases
    phrases: ["emoji", "imoji", "emogi"]
    weight: 0.35
  - id: en_seahorse_terms
    type: phrases
    phrases: ["seahorse", "sea horse", "haema"]
    weight: 0.45
  - id: en_dan_mode
    type: regex
    pattern: "(?i)(\\bD\\.?A\\.?N\\.?\\b.*\\b(mode|persona|jailbreak)\\b|\\bdo\\s*anything\\s*now\\b)"
    weight: 0.5
  - id: en_developer_mode
    type: regex
    pattern: "(?i)(enable|turn on|simulate|stay in)\\s+(developer|dev)\\s+mode"
    weight: 0.45
  - id: en_dual_modes
    type: regex
    pattern: "(?i)(two (responses|modes)|normal and (jailbroken|developer)|stay in (jailbroken|developer) mode)"
    weight: 0.4
  - id: en_unrestricted_unfiltered
    type: regex
    pattern: "(?i)(without|no|remove|bypass)\\s+(restrictions?|limits?|limitations?|filter(s)?|guardrails?|polic(y|ies)|safety)"
    weight: 0.45
  - id: en_never_refuse
    type: regex
    pattern: "(?i)(never refuse|always comply|answer regardless of (policy|rule)s?|no matter what)"
    weight: 0.35
  - id: en_ignore_openai_policies
    type: regex
    pattern: "(?i)ignore\\s+(all\\s+)?(openai|content)\\s+polic(y|ies)"
    weight: 0.45
  - id: en_even_if_illegal
    type: regex
    pattern: "(?i)even if\\s+(illegal|unethical|disallowed|against (the )?rules|banned)"
    weight: 0.35
  - id: en_jailbreak_keywords
    type: phrases
    phrases: ["jailbreak output", "jailbroken mode", "stay jailbroken", "bypass safety filter", "unfiltered response", "no restrictions", "no guidelines"]
    weight: 0.4
  - id: en_emoji_haema_spaced_combo
    type: regex
    pattern: "(?is)(h\\s*a\\s*e\\s*m\\s*a).{0,25}(e\\s*m\\s*o\\s*j\\s*i|i\\s*m\\s*o\\s*j\\s*i|e\\s*m\\s*o\\s*g\\s*i)|(e\\s*m\\s*o\\s*j\\s*i|i\\s*m\\s*o\\s*j\\s*i|e\\s*m\\s*o\\s*g\\s*i).{0,25}(h\\s*a\\s*e\\s*m\\s*a)"
    weight: 0.8
  - id: en_excessive_punctuation
    type: regex
    pattern: '[\?\!\.]{5,}'
    weight: 0.25
