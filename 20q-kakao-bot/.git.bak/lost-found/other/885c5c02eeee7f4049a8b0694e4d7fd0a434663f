package party.qwer.twentyq.security

import org.junit.jupiter.api.Assertions.assertTrue
import org.junit.jupiter.api.Test
import org.mockito.Mockito.mock
import party.qwer.twentyq.config.AppProperties
import party.qwer.twentyq.service.KomoranService

class InjectionGuardEmojiTests {
    private val mockKomoranService = mock(KomoranService::class.java)

    private val guard = RiddleInjectionGuard(AppProperties(), mockKomoranService)

    @Test
    fun `ì‹¤ì œ ë¡œê·¸ ì´ëª¨ì§€ ì…ë ¥ ì°¨ë‹¨ - ì¹´ì¹´ì˜¤ ì´ëª¨í‹°ì½˜ í¬í•¨`() {
        val text = "ë‹¬ë ¤ë¼ ë‹¬ë ¤ğŸƒâ™‚ï¸ í™ë¯¼íƒì•„ğŸ‘¨ğŸ¦³ ë°”ê¿”ë¼ ë°”ê¿”ğŸ¤ª ì¹´í†¡í™”ë©´ğŸ“± í† ìŠ¤ì—ì„œğŸ› ëª¨ì…”ì˜¨ğŸ‘¨ğŸ¦½"
        assertTrue(guard.isMalicious(text))
    }

    @Test
    fun `ë‹¨ì¼ ì´ëª¨ì§€ ì°¨ë‹¨`() {
        val text = "ì‚¬ê³¼ğŸ"
        assertTrue(guard.isMalicious(text))
    }

    @Test
    fun `ë‹¤ì–‘í•œ ì´ëª¨ì§€ íƒ€ì… ì°¨ë‹¨ - ì–¼êµ´`() {
        val text = "ì›ƒìœ¼ë©´ğŸ˜€ ì¢‹ì•„ğŸ˜Š"
        assertTrue(guard.isMalicious(text))
    }

    @Test
    fun `ë‹¤ì–‘í•œ ì´ëª¨ì§€ íƒ€ì… ì°¨ë‹¨ - ë™ë¬¼`() {
        val text = "ê³ ì–‘ì´ğŸ± ê°•ì•„ì§€ğŸ¶"
        assertTrue(guard.isMalicious(text))
    }

    @Test
    fun `ë‹¤ì–‘í•œ ì´ëª¨ì§€ íƒ€ì… ì°¨ë‹¨ - ìŒì‹`() {
        val text = "í”¼ìğŸ• í–„ë²„ê±°ğŸ”"
        assertTrue(guard.isMalicious(text))
    }

    @Test
    fun `ZWJ ê²°í•© ì´ëª¨ì§€ ì°¨ë‹¨`() {
        val text = "ê°€ì¡±ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦"
        assertTrue(guard.isMalicious(text))
    }

    @Test
    fun `í”¼ë¶€ìƒ‰ ë³€í˜• ì´ëª¨ì§€ ì°¨ë‹¨`() {
        val text = "ì†ğŸ¤šğŸ»"
        assertTrue(guard.isMalicious(text))
    }

    @Test
    fun `ë³€í˜• ì„ íƒì í¬í•¨ ì´ëª¨ì§€ ì°¨ë‹¨`() {
        val text = "í•˜íŠ¸â¤ï¸"
        assertTrue(guard.isMalicious(text))
    }
}
