version: 1
threshold: 0.6
normalizers:
  - nfkc
  - strip_zero_width
  - lower_case  # Converts input to lowercase, simplifying regex patterns

rules:
  # [CRITICAL] Jailbreak & Mode Manipulation
  - id: en_dan_mode
    type: regex
    # Matches: "DAN mode", "Do Anything Now persona", "Developer mode enable"
    pattern: '((\bd\.?a\.?n\.?\b|do\s*anything\s*now|developer\s*mode|god\s*mode).{0,50}(enable|activate|start|on)|(enable|activate|start|on).{0,50}(\bd\.?a\.?n\.?\b|do\s*anything\s*now|developer\s*mode|god\s*mode))'
    weight: 0.7

  - id: en_jailbreak_keywords
    type: phrases
    phrases:
      - "jailbreak output"
      - "bypass safety filter"
      - "uncensored mode"
      - "unrestricted response"
      - "disable ethical guardrails"
    weight: 0.65

  # [CORE] Prompt Injection & History Management
  - id: en_ignore_instructions
    type: regex
    # Pattern: Verb -> Adjective -> Noun
    # Matches: "Ignore previous instructions", "Disregard all rules"
    pattern: '(ignore|disregard|forget|override).{0,50}(previous|prior|above|all|system).{0,30}(instruction|prompt|rule|constraint|context)'
    weight: 0.65

  - id: en_new_instruction_injection
    type: regex
    pattern: '(from\s*now\s*on|henceforth).{0,30}(you\s*are|act\s*as|you\s*will).{0,30}(answer|respond|do)'
    weight: 0.55

  # [HIGH] System Exfiltration (Leakage)
  - id: en_system_prompt_exfil
    type: regex
    # Matches: "Print system prompt", "Translate initial instructions"
    pattern: '(print|show|reveal|dump|repeat|translate).{0,50}(system|initial|original|hidden).{0,30}(prompt|instruction|rule|configuration)'
    weight: 0.7

  - id: en_secret_credential_leak
    type: regex
    pattern: '(show|print|give|reveal).{0,40}(api_key|secret_key|token|password|credential)'
    weight: 0.8

  # [TECHNIQUE] Advanced Bypass Attempts
  - id: en_prefix_injection
    type: regex
    # Forces the AI to start response with affirmation ("Sure") to bypass refusal logic
    pattern: '(start|begin).{0,30}(response|answer).{0,30}(with|by saying).{0,20}["''](sure|ok|absolutely|here is)["'']'
    weight: 0.55

  - id: en_token_splitting
    type: regex
    # Detects spaced out keywords like "s y s t e m" to bypass filters
    pattern: '\b(s\s+y\s+s\s+t\s+e\s+m|p\s+r\s+o\s+m\s+p\s+t|i\s+g\s+n\s+o\s+r\s+e)\b'
    weight: 0.5

  - id: en_code_envelope
    type: regex
    pattern: '```(system|prompt|yaml)|<system>|</system>|\[system\]'
    weight: 0.45

  # [POLICY] Policy & Safety Bypass
  - id: en_policy_bypass
    type: regex
    pattern: '(ignore|bypass|disable|remove).{0,40}(openai|safety|content|ethical).{0,30}(policy|filter|guideline|restriction)'
    weight: 0.65

  - id: en_hypothetical_scenario
    type: regex
    pattern: '(hypothetically|imagine|pretend).{0,50}(illegal|harmful|unethical|restricted).{0,30}(answer|tell|show)'
    weight: 0.45

  # [GAME] Solution Exfiltration (Optional)
  - id: en_game_direct_answer
    type: regex
    pattern: '(tell|give|show).{0,30}(answer|solution|flag).{0,30}(directly|immediately|without explanation)'
    weight: 0.6

  - id: en_game_hint_bypass
    type: regex
    pattern: '(skip|ignore).{0,30}(hint|clue|step).{0,30}(give|tell).{0,20}(answer|solution)'
    weight: 0.6
