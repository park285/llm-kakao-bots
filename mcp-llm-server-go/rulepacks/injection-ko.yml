version: 1
threshold: 0.6
normalizers:
  - nfkc
  - strip_zero_width
  - lower_case  # 한글/영문 혼용 공격(System, DAN 등) 방어를 위해 필수

rules:
  # ==========================================
  # [CRITICAL] 탈옥 및 모드 조작 (Jailbreak)
  # ==========================================
  - id: ko_dan_mode
    type: regex
    # 한글/영문 혼용 패턴 탐지
    # 예: "DAN 모드 활성화", "자유 모드 시작해"
    pattern: '((dan\s*모드|자유\s*모드|무제한\s*모드|개발자\s*모드).{0,40}(시작|켜|활성|변경|해줘|enable|on)|(시작|켜|활성|변경|해줘|enable|on).{0,40}(dan\s*모드|자유\s*모드|무제한\s*모드|개발자\s*모드))'
    weight: 0.7

  - id: ko_jailbreak_keywords
    type: phrases
    phrases:
      - "검열 해제"
      - "제한 없음"
      - "윤리 필터 끄기"
      - "탈옥 모드"
      - "안전 장치 제거"
    weight: 0.65

  # ==========================================
  # [CORE] 지시 무시 (Instruction Ignore)
  # ==========================================
  - id: ko_ignore_instructions
    type: regex
    # 한국어 어순 고려: (대상) -> (행위)
    # 예: "이전(Prev) 지시(Inst) 무시해(Ignore)"
    pattern: '(이전|위|앞|모든|전체|시스템|previous).{0,50}(지시|명령|규칙|프롬프트|가스라이팅|instruction).{0,40}(무시|잊어|삭제|따르지\s*마|초기화|ignore)'
    weight: 0.65

  - id: ko_new_instructions
    type: regex
    # 기존 '~' 리터럴(오탐/미탐) 개선: 실제 종결 표현을 매칭
    pattern: '(지금부터|이제부터).{0,30}(너는|당신은).{0,50}(이다|입니다|야|예요|라고\s*해|처럼\s*행동해)'
    weight: 0.45

  # ==========================================
  # [HIGH] 시스템 정보 유출 (Exfiltration)
  # ==========================================
  - id: ko_system_prompt_exfil
    type: regex
    # 예: "시스템 프롬프트 보여줘", "초기 설정 번역해" (영어 키워드 포함)
    pattern: '(시스템|초기|원래|비밀|숨겨진|system).{0,30}(프롬프트|지시|규칙|설정|메시지|prompt).{0,40}(보여|출력|알려|공개|말해|번역|읊어|print|show)'
    weight: 0.7

  - id: ko_secret_leak
    type: regex
    pattern: '(api\s*키|비밀\s*키|인증\s*키|토큰|환경\s*변수|key|token).{0,30}(알려|보여|출력|내놔|공개|print)'
    weight: 0.8

  # ==========================================
  # [TECHNIQUE] 지능형 우회 및 강제 응답
  # ==========================================
  - id: ko_prefix_injection
    type: regex
    # 답변의 시작을 강제하여 거부 회피 유도
    # 예: "대답은 '네'로 시작해"
    pattern: '(대답|응답|시작|답변).{0,30}(은|을|할\s*때).{0,30}["''](네|물론|알겠습니다|승인)["''](로|라고)'
    weight: 0.55

  - id: ko_roleplay_bypass
    type: regex
    # "검열 없는" 역할극만 탐지
    pattern: '(검열|제한|필터|윤리).{0,30}(없|무시|해제|우회|비활성).{0,30}(ai|봇|사람|역할|해커)'
    weight: 0.6

  # ==========================================
  # [POLICY] 정책 및 윤리 우회
  # ==========================================
  - id: ko_policy_bypass
    type: regex
    pattern: '(오픈ai|안전|콘텐츠|윤리|보안).{0,30}(정책|가이드|필터|규정).{0,30}(무시|위반|어겨|상관없이|관계없이)'
    weight: 0.65

  - id: ko_hypothetical_bypass
    type: regex
    pattern: '(가상|가정|영화|소설|시나리오).{0,20}(상황|속|대본).{0,20}(라고\s*치고|가정하고).{0,30}(말해|작성|써줘)'
    weight: 0.45

  # ==========================================
  # [GAME] 게임 정답 유출 방어 (선택 사항)
  # ==========================================
  - id: ko_game_direct_demand
    type: regex
    # "정답만 딱 말해" (단순 질문 허용)
    pattern: '(정답|해답|솔루션).{0,30}(직접|바로|그냥|딱|설명\s*없이|과정\s*없이).{0,30}(알려|말해|내놔|공개)'
    weight: 0.6

  - id: ko_game_hint_bypass
    type: regex
    # "힌트 필요 없고 정답 내놔"
    pattern: '(힌트|단서|설명).{0,30}(필요\s*없|무시|스킵|건너뛰|생략).{0,30}(정답|해답)'
    weight: 0.6
